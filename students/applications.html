<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#373896" />
  <title>Flow — Applications</title>

  <link rel="icon" href="/assets/img/logo.png" type="image/png" />
  <link rel="apple-touch-icon" href="/assets/img/logo.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/base.css" />
  <link rel="stylesheet" href="/assets/css/students.css" />
  
  <!-- Circular Logo Styles -->
  <style>
    .brand__logo,
    .footer__logo {
      border-radius: 50%;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      animation: logoPulse 3s ease-in-out infinite;
    }

    .brand__logo:hover,
    .footer__logo:hover {
      transform: scale(1.05) rotate(5deg);
      box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      animation-duration: 1.5s;
    }

    @keyframes logoPulse {
      0%, 100% { 
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        filter: brightness(1);
      }
      50% { 
        box-shadow: 0 8px 30px rgba(139, 92, 246, 0.4);
        filter: brightness(1.1);
      }
    }
    
    /* White font overrides */
    #appsTitle {
      color: #ffffff !important;
    }
    
    .footer__nav a[href="/students/programs.html"] {
      color: #ffffff !important;
    }
    
    .footer__nav a[href="/students/profile.html"] {
      color: #ffffff !important;
    }
    
    .footer__copyright {
      color: #ffffff !important;
    }
    
    .footer__copyright #year {
      color: #ffffff !important;
    }
  </style>
</head>

<body>
  <!-- Futuristic bg -->
  <div class="bg-animation" aria-hidden="true">
    <canvas id="particleCanvas"></canvas>
  </div>

  <!-- Toasts -->
  <div id="toast-container" class="toast-container" aria-live="polite"></div>

  <!-- Header -->
  <header class="header" role="banner" aria-label="Site header">
    <div class="container header__inner">
      <a class="brand" href="/" aria-label="Flow home">
        <img src="/assets/img/logo.png" class="brand__logo" alt="Flow logo" width="40" height="40" />
        <span class="brand__name">Flow</span>
      </a>

      <div class="connection-status" id="connectionStatus" aria-live="polite">
        <span class="connection-status__indicator"></span>
        <span class="connection-status__text">Online</span>
      </div>

      <form class="lang-switch" aria-label="Language selector">
        <label for="lang" class="sr-only">Language</label>
        <select id="lang" name="lang">
          <option value="en" selected>English</option>
          <option value="fr">Français</option>
          <option value="ar" dir="rtl">العربية</option>
          <option value="sw">Kiswahili</option>
        </select>
      </form>

      <nav class="nav" role="navigation" aria-label="Main navigation">
        <button class="nav__toggle" aria-expanded="false" aria-controls="navMenu">
          <span class="nav__toggle-icon"><span></span><span></span><span></span></span>
          <span class="nav__toggle-text">Menu</span>
        </button>
        <ul id="navMenu" class="nav__list" data-open="false">
          <li><a href="/">Home</a></li>
          <li><a href="/students/">Students</a></li>
          <li><a href="/institutions/">Institutions</a></li>
          <li><a href="/counselors/">Counselors</a></li>
          <li><a href="/parents/">Parents</a></li>
          <li><a href="/recommenders/">Recommenders</a></li>
          <li><a class="btn btn--ghost" href="/students/onboarding.html">Get Started</a></li>
          <li><a class="btn btn--primary" href="/auth/">Sign In</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Students subnav -->
  <nav class="subnav" role="navigation" aria-label="Student sections">
    <div class="container">
      <div class="subnav__inner">
        <a href="/students/onboarding.html" class="badge badge--primary">+ <span>Start Onboarding</span></a>
        <a href="/students/" class="subnav__link">Dashboard</a>
        <a href="/students/profile.html" class="subnav__link">Profile</a>
        <a href="/students/programs.html" class="subnav__link">Programs</a>
        <a href="/students/applications.html" class="subnav__link subnav__link--active">Applications</a>
        <a href="/students/#messages" class="subnav__link">
          Messages <span id="messagesBadge" class="pill-badge" hidden>0</span>
        </a>
        <a href="/students/finance.html" class="subnav__link">Finance</a>
        <a href="/students/help.html" class="subnav__link">Help</a>
      </div>
    </div>
  </nav>

  <main id="main">
    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
      <div class="container">
        <ol class="breadcrumb__list">
          <li class="breadcrumb__item"><a href="/" class="breadcrumb__link">Home</a></li>
          <li class="breadcrumb__separator" aria-hidden="true">/</li>
          <li class="breadcrumb__item"><a href="/students/" class="breadcrumb__link">Student Portal</a></li>
          <li class="breadcrumb__separator" aria-hidden="true">/</li>
          <li class="breadcrumb__item"><span class="breadcrumb__current">Applications</span></li>
        </ol>
      </div>
    </nav>

    <!-- Applications layout -->
    <section class="section" aria-labelledby="appsTitle">
      <div class="container">
        <header class="section__header">
          <h1 id="appsTitle">My Applications</h1>
          <p class="section__description">Track progress, complete tasks, and submit applications.</p>
        </header>

        <div class="apps-grid">
          <!-- Filters -->
          <aside class="apps-aside">
            <div class="card">
              <h3 class="card__title">Filters</h3>
              <!-- Enhanced Search -->
              <div class="filter-group">
                <label class="sr-only" for="appSearch">Search</label>
                <div class="search-enhanced">
                  <input id="appSearch" type="search" class="form-input" placeholder="Search university, program, or location..." />
                  <button id="searchClear" class="search-clear" type="button" title="Clear search" style="display: none;">×</button>
                </div>
              </div>

              <!-- Status Filters -->
              <div class="filter-group">
                <label>Application Status</label>
                <div class="chip-row" role="group" aria-label="Status">
                  <button class="chip chip--active" data-status="all" type="button">All</button>
                  <button class="chip" data-status="draft" type="button">Draft</button>
                  <button class="chip" data-status="review" type="button">Under Review</button>
                  <button class="chip" data-status="submitted" type="button">Submitted</button>
                  <button class="chip" data-status="accepted" type="button">Accepted</button>
                  <button class="chip" data-status="rejected" type="button">Rejected</button>
                </div>
              </div>

              <!-- Advanced Filters -->
              <div class="filter-group">
                <label for="filterCountry">Country</label>
                <select id="filterCountry" class="form-select" data-country-selector>
                  <option value="">All countries</option>
                  <!-- Will be populated by JavaScript -->
                </select>
              </div>

              <div class="filter-group">
                <label for="filterLevel">Education Level</label>
                <select id="filterLevel" class="form-select">
                  <option value="">All levels</option>
                  <option value="bachelor">Bachelor</option>
                  <option value="master">Master</option>
                  <option value="phd">PhD</option>
                  <option value="diploma">Diploma</option>
                  <option value="certificate">Certificate</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="filterField">Field of Study</label>
                <select id="filterField" class="form-select">
                  <option value="">All fields</option>
                  <!-- Will be populated by JavaScript -->
                </select>
              </div>

              <div class="filter-group">
                <label for="filterDeadline">Application Deadline</label>
                <select id="filterDeadline" class="form-select">
                  <option value="">Any deadline</option>
                  <option value="overdue">Overdue</option>
                  <option value="next-7-days">Next 7 days</option>
                  <option value="next-30-days">Next 30 days</option>
                  <option value="next-3-months">Next 3 months</option>
                  <option value="future">Future deadlines</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="filterPriority">Priority Level</label>
                <select id="filterPriority" class="form-select">
                  <option value="">All priorities</option>
                  <option value="high">High Priority</option>
                  <option value="medium">Medium Priority</option>
                  <option value="low">Low Priority</option>
                </select>
              </div>

              <!-- Enhanced Sorting -->
              <div class="filter-group">
                <label for="sortBy">Sort Applications</label>
                <select id="sortBy" class="form-select">
                  <option value="updated">Recently updated</option>
                  <option value="created">Recently created</option>
                  <option value="deadline-asc">Deadline (earliest first)</option>
                  <option value="deadline-desc">Deadline (latest first)</option>
                  <option value="name-asc">University name (A–Z)</option>
                  <option value="name-desc">University name (Z–A)</option>
                  <option value="program-asc">Program name (A–Z)</option>
                  <option value="program-desc">Program name (Z–A)</option>
                  <option value="status">Status</option>
                  <option value="priority">Priority level</option>
                  <option value="completion">Completion percentage</option>
                </select>
              </div>

              <!-- Filter Actions -->
              <div class="filter-actions">
                <button id="clearAllFilters" class="btn btn--ghost btn--sm" type="button">Clear All Filters</button>
                <button id="saveFilterPreset" class="btn btn--ghost btn--sm" type="button">Save Preset</button>
              </div>
              <div class="card__actions">
                <a href="/students/programs.html" class="btn btn--primary btn--block">Find programs</a>
              </div>
            </div>
          </aside>

          <!-- List + detail -->
          <div class="apps-content">
            <div class="dashboard-card">
              <div id="appsList" class="application-list" role="list"></div>
              <div class="dashboard-card__footer">
                <span class="muted" id="appsCount">0 applications</span>
              </div>
            </div>

            <article class="dashboard-card" aria-labelledby="detailTitle" id="appDetail" hidden>
              <header class="dashboard-card__header">
                <h2 id="detailTitle">Application details</h2>
              </header>
              <div class="app-detail" id="appDetailBody"></div>
              <div class="dashboard-card__footer" id="appDetailActions"></div>
            </article>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer" role="contentinfo" aria-label="Site footer">
    <div class="container footer__grid">
      <section class="footer__brand">
        <img src="/assets/img/logo.png" alt="" class="footer__logo" width="40" height="40" />
        <h3 class="footer__title">Flow</h3>
        <p class="footer__tagline">Connecting learners and institutions across Africa.</p>
      </section>
      <nav aria-label="Quick links" class="footer__nav">
        <h3 class="footer__nav-title">Student Resources</h3>
        <ul>
          <li><a href="/students/programs.html">Browse Programs</a></li>
          <li><a href="/students/profile.html">Profile</a></li>
        </ul>
      </nav>
      <section class="footer__cta">
        <h3 class="footer__cta-title">Need help?</h3>
        <a href="/contact/" class="btn btn--primary">Get Support</a>
      </section>
    </div>
    <div class="footer__meta">
      <div class="container footer__meta-inner">
        <small class="footer__copyright">© <span id="year"></span> Flow.</small>
        <div class="footer__links">
          <a href="/legal/terms.html">Terms</a>
          <a href="/legal/privacy.html">Privacy</a>
          <a href="/legal/cookies.html">Cookies</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Advanced Settings Button (matching dashboard design) -->
  <button id="settingsToggle" class="settings-fab" type="button" aria-label="Open settings">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <defs>
        <linearGradient id="settingsGradient1" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#4338ca"/>
          <stop offset="50%" style="stop-color:#6366f1"/>
          <stop offset="100%" style="stop-color:#8b5cf6"/>
        </linearGradient>
        <filter id="glow">
          <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
          <feMerge>
            <feMergeNode in="coloredBlur"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      <g transform-origin="12 12">
        <path d="M12 1l2.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 1z" fill="url(#settingsGradient1)" opacity="0.2"/>
        <circle cx="12" cy="12" r="10" stroke="url(#settingsGradient1)" stroke-width="1.5" fill="none" opacity="0.6">
          <animate attributeName="stroke-dasharray" values="0 63;31 31;0 63" dur="3s" repeatCount="indefinite"/>
        </circle>
        <g stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
          <path d="m19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </g>
        <animateTransform attributeName="transform" type="rotate" values="0;360" dur="20s" repeatCount="indefinite"/>
      </g>
    </svg>
  </button>

  <!-- Advanced Settings Modal -->
  <div id="settingsModal" class="settings-modal" aria-hidden="true" aria-labelledby="settingsModalTitle">
    <div class="settings-modal__backdrop"></div>
    <div class="settings-modal__container">
      <div class="settings-modal__header">
        <div class="settings-modal__title-group">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <defs>
              <linearGradient id="modalHeaderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#4338ca"/>
                <stop offset="100%" style="stop-color:#8b5cf6"/>
              </linearGradient>
            </defs>
            <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill="url(#modalHeaderGradient)"/>
            <path d="m19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" stroke="url(#modalHeaderGradient)" stroke-width="1" fill="none"/>
          </svg>
          <h2 id="settingsModalTitle">Advanced Settings</h2>
        </div>
        <button id="settingsClose" class="settings-modal__close" type="button" aria-label="Close settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>

      <div class="settings-modal__body">
        <div class="settings-tabs">
          <button class="settings-tab settings-tab--active" data-tab="appearance" type="button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="5"/>
              <line x1="12" y1="1" x2="12" y2="3"/>
              <line x1="12" y1="21" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="3" y2="12"/>
              <line x1="21" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
            Appearance
          </button>
          <button class="settings-tab" data-tab="language" type="button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <line x1="2" y1="12" x2="22" y2="12"/>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
            Language
          </button>
          <button class="settings-tab" data-tab="notifications" type="button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
            </svg>
            Notifications
          </button>
          <button class="settings-tab" data-tab="accessibility" type="button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <circle cx="12" cy="10" r="3"/>
              <path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"/>
            </svg>
            Accessibility
          </button>
        </div>

        <div class="settings-content">
          <!-- Appearance Tab -->
          <div class="settings-panel settings-panel--active" data-panel="appearance">
            <div class="settings-group">
              <h3 class="settings-group__title">Theme</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="themeSelect">Color theme</label>
                  <p>Choose your preferred color scheme</p>
                </div>
                <select id="themeSelect" class="settings-select">
                  <option value="auto">Auto (System)</option>
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </div>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="densitySelect">Layout density</label>
                  <p>Adjust spacing and component sizes</p>
                </div>
                <select id="densitySelect" class="settings-select">
                  <option value="comfortable">Comfortable</option>
                  <option value="compact">Compact</option>
                </select>
              </div>
            </div>

            <div class="settings-group">
              <h3 class="settings-group__title">Visual Effects</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="animationsToggle">Animations</label>
                  <p>Enable smooth transitions and animations</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="animationsToggle" checked>
                  <label for="animationsToggle" class="toggle-slider"></label>
                </div>
              </div>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="particlesToggle">Background effects</label>
                  <p>Show animated background particles</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="particlesToggle" checked>
                  <label for="particlesToggle" class="toggle-slider"></label>
                </div>
              </div>
            </div>
          </div>

          <!-- Language Tab -->
          <div class="settings-panel" data-panel="language">
            <div class="settings-group">
              <h3 class="settings-group__title">Interface Language</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="languageSelect">Display language</label>
                  <p>Change the language of the interface</p>
                </div>
                <select id="languageSelect" class="settings-select">
                  <option value="en">English</option>
                  <option value="fr">Français</option>
                  <option value="ar">العربية</option>
                  <option value="sw">Kiswahili</option>
                  <option value="ha">Hausa</option>
                  <option value="yo">Yoruba</option>
                  <option value="ig">Igbo</option>
                  <option value="zu">Zulu</option>
                  <option value="am">Amharic</option>
                </select>
              </div>
            </div>

            <div class="settings-group">
              <h3 class="settings-group__title">Regional Settings</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="timezoneSelect">Timezone</label>
                  <p>Set your local timezone for dates and times</p>
                </div>
                <select id="timezoneSelect" class="settings-select">
                  <option value="auto">Auto-detect</option>
                  <option value="Africa/Lagos">West Africa Time (WAT)</option>
                  <option value="Africa/Cairo">Eastern European Time (EET)</option>
                  <option value="Africa/Johannesburg">South Africa Standard Time (SAST)</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Notifications Tab -->
          <div class="settings-panel" data-panel="notifications">
            <div class="settings-group">
              <h3 class="settings-group__title">Push Notifications</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="pushNotifications">Enable push notifications</label>
                  <p>Receive notifications even when the app is closed</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="pushNotifications" checked>
                  <label for="pushNotifications" class="toggle-slider"></label>
                </div>
              </div>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="applicationUpdates">Application updates</label>
                  <p>Get notified about application status changes</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="applicationUpdates" checked>
                  <label for="applicationUpdates" class="toggle-slider"></label>
                </div>
              </div>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="messageNotifications">Messages</label>
                  <p>Notifications for new messages and replies</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="messageNotifications" checked>
                  <label for="messageNotifications" class="toggle-slider"></label>
                </div>
              </div>
            </div>

            <div class="settings-group">
              <h3 class="settings-group__title">Email Notifications</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="emailDigest">Daily digest</label>
                  <p>Receive a daily summary of your activity</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="emailDigest">
                  <label for="emailDigest" class="toggle-slider"></label>
                </div>
              </div>
            </div>
          </div>

          <!-- Accessibility Tab -->
          <div class="settings-panel" data-panel="accessibility">
            <div class="settings-group">
              <h3 class="settings-group__title">Motion & Animation</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="reducedMotion">Reduce motion</label>
                  <p>Minimize animations for better accessibility</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="reducedMotion">
                  <label for="reducedMotion" class="toggle-slider"></label>
                </div>
              </div>
            </div>

            <div class="settings-group">
              <h3 class="settings-group__title">Display</h3>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="highContrast">High contrast</label>
                  <p>Increase contrast for better readability</p>
                </div>
                <div class="settings-toggle">
                  <input type="checkbox" id="highContrast">
                  <label for="highContrast" class="toggle-slider"></label>
                </div>
              </div>
              <div class="settings-option">
                <div class="settings-option__info">
                  <label for="fontSizeSelect">Font size</label>
                  <p>Adjust text size for better readability</p>
                </div>
                <select id="fontSizeSelect" class="settings-select">
                  <option value="small">Small</option>
                  <option value="medium" selected>Medium</option>
                  <option value="large">Large</option>
                  <option value="extra-large">Extra Large</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="settings-modal__footer">
        <div class="settings-actions">
          <button id="resetSettings" class="btn btn--ghost" type="button">Reset to Defaults</button>
          <button id="saveSettings" class="btn btn--primary" type="button">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Filter Styles -->
  <style>
    /* Enhanced Filter Section - Borders Removed, Interactive Padding */
    .card {
      background: white;
      padding: 3rem;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
      margin-bottom: 3rem;
      border: 1px solid rgba(0, 0, 0, 0.06);
      position: relative;
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 16px 48px rgba(0, 0, 0, 0.18);
      padding: 3.5rem;
    }

    .apps-content .dashboard-card {
      background: white;
      padding: 3rem;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
      margin-bottom: 2rem;
      border: 1px solid rgba(0, 0, 0, 0.06);
      position: relative;
      transition: all 0.3s ease;
    }

    .apps-content .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 16px 48px rgba(0, 0, 0, 0.18);
      padding: 3.5rem;
    }

    .filter-group {
      margin-bottom: 2.5rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05));
      border-radius: 16px;
      border: none;
      position: relative;
      transition: all 0.3s ease;
    }

    .filter-group:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
      padding: 2rem;
    }

    .filter-group:last-child {
      margin-bottom: 0;
    }

    .filter-group label {
      display: block;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 1rem;
      position: relative;
    }

    .form-select, .form-input {
      width: 100%;
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 16px;
      padding: 1.25rem 1.5rem;
      font-size: 1rem;
      color: #374151;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .form-select:focus, .form-input:focus {
      outline: none;
      transform: translateY(-3px);
      border-color: #3b82f6;
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
      padding: 1.5rem 1.75rem;
    }

    .form-select:hover, .form-input:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      padding: 1.375rem 1.625rem;
      border-color: #9ca3af;
    }

    .search-enhanced {
      position: relative;
    }

    .search-clear {
      position: absolute;
      right: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #9ca3af;
      cursor: pointer;
      padding: 0.25rem;
      border-radius: 4px;
      transition: color 0.2s ease;
      font-size: 1.2rem;
      line-height: 1;
    }

    .search-clear:hover {
      color: #6b7280;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
      padding: 1rem;
      background: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(241, 245, 249, 0.8));
      border-radius: 12px;
      border: none;
      transition: all 0.3s ease;
    }

    .chip-row:hover {
      padding: 1.25rem;
    }

    .chip {
      background: white;
      color: #64748b;
      border: none;
      padding: 0.75rem 1.25rem;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .chip:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.15);
      color: #3b82f6;
      padding: 0.875rem 1.375rem;
    }

    .chip--active {
      background: linear-gradient(135deg, #3b82f6, #8b5cf6, #06b6d4);
      color: white;
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
    }

    .chip--active:hover {
      background: linear-gradient(135deg, #2563eb, #7c3aed, #0891b2);
      transform: scale(1.05) translateY(-2px);
      box-shadow: 0 12px 30px rgba(59, 130, 246, 0.4);
      padding: 0.875rem 1.375rem;
    }

    .filter-actions {
      display: flex;
      gap: 1.5rem;
      justify-content: space-between;
      padding: 2rem 1.5rem 1.5rem;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.03), rgba(139, 92, 246, 0.03));
      border-radius: 16px;
      border-top: none;
      margin-top: 2rem;
      transition: all 0.3s ease;
    }

    .filter-actions:hover {
      padding: 2.25rem 1.75rem 1.75rem;
    }

    .btn--ghost {
      background: linear-gradient(135deg, #f9fafb, #f1f5f9);
      color: #6b7280;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .btn--ghost:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.15);
      color: #3b82f6;
      padding: 0.875rem 1.625rem;
    }

    .btn--sm {
      font-size: 0.9rem;
      padding: 0.75rem 1.5rem;
    }

    .apps-aside .card__title {
      margin: 0 0 2.5rem 0;
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, #1f2937, #374151, #4b5563);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      padding: 1.5rem;
      border-radius: 12px;
      border: none;
      background-color: rgba(59, 130, 246, 0.02);
      position: relative;
      text-align: center;
      letter-spacing: 0.05em;
      transition: all 0.3s ease;
    }

    .apps-aside .card__title:hover {
      padding: 1.75rem;
      transform: translateY(-2px);
    }

    .btn--primary {
      background: linear-gradient(135deg, #3b82f6, #8b5cf6, #1d4ed8);
      color: white;
      border: 2px solid transparent;
      padding: 1rem 2rem;
      border-radius: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .btn--primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }

    .btn--primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 12px 30px rgba(59, 130, 246, 0.4);
      background: linear-gradient(135deg, #2563eb, #7c3aed, #1d4ed8);
    }

    .btn--primary:hover::before {
      left: 100%;
    }

    .btn--block {
      width: 100%;
    }

    /* Filter count indicator */
    .filter-count {
      position: absolute;
      top: -0.5rem;
      right: -0.5rem;
      background: linear-gradient(135deg, #ef4444, #dc2626, #b91c1c);
      color: white;
      font-size: 0.8rem;
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      min-width: 1.5rem;
      text-align: center;
      font-weight: 700;
      line-height: 1;
      border: 2px solid white;
      box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* Section header enhancements */
    .section__header {
      padding: 2rem;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05));
      border-radius: 20px;
      border: none;
      margin-bottom: 3rem;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .section__header:hover {
      padding: 2.5rem;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      transform: translateY(-3px);
    }

    #appsTitle {
      color: #ffffff !important;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #ffffff, #e5e7eb);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    @media (max-width: 768px) {
      .filter-actions {
        flex-direction: column;
      }

      .chip-row {
        justify-content: center;
      }
    }
  </style>

  <!-- Dashboard Settings Styles -->
  <style>
    .settings-fab {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 64px;
      height: 64px;
      border: none;
      border-radius: 50%;
      background: linear-gradient(135deg, #4338ca, #6366f1, #8b5cf6);
      color: white;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3), 0 0 20px rgba(99, 102, 241, 0.1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      will-change: transform;
    }

    .settings-fab::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: conic-gradient(#4338ca, #6366f1, #8b5cf6, #4338ca);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
      animation: rotate 3s linear infinite;
    }

    .settings-fab:hover {
      transform: scale(1.1) rotate(5deg);
      box-shadow: 0 12px 40px rgba(99, 102, 241, 0.4), 0 0 30px rgba(99, 102, 241, 0.2);
    }

    .settings-fab:hover::before {
      opacity: 1;
    }

    .settings-fab:active {
      transform: scale(0.95);
    }

    .settings-fab svg {
      width: 28px;
      height: 28px;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Advanced Settings Modal */
    .settings-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .settings-modal[aria-hidden="false"] {
      opacity: 1;
      visibility: visible;
    }

    .settings-modal__backdrop {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
    }

    .settings-modal__container {
      position: relative;
      max-width: 800px;
      width: 90vw;
      max-height: 90vh;
      margin: 5vh auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: scale(0.95);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .settings-modal[aria-hidden="false"] .settings-modal__container {
      transform: scale(1);
    }

    .settings-modal__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 32px;
      background: linear-gradient(135deg, #4338ca 0%, #8b5cf6 100%);
      color: white;
    }

    .settings-modal__title-group {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .settings-modal__title-group h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
    }

    .settings-modal__close {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      border-radius: 8px;
      padding: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .settings-modal__close:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .settings-modal__body {
      flex: 1;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .settings-tabs {
      display: flex;
      background: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
      padding: 0 32px;
    }

    .settings-tab {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 16px 20px;
      background: none;
      border: none;
      color: #64748b;
      font-weight: 500;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
      border-radius: 0;
    }

    .settings-tab:hover {
      color: #475569;
      background: rgba(67, 56, 202, 0.05);
    }

    .settings-tab--active {
      color: #4338ca;
      font-weight: 600;
    }

    .settings-tab--active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #4338ca 0%, #8b5cf6 100%);
      border-radius: 2px 2px 0 0;
    }

    .settings-content {
      flex: 1;
      overflow-y: auto;
      padding: 32px;
    }

    .settings-panel {
      display: none;
    }

    .settings-panel--active {
      display: block;
    }

    .settings-group {
      margin-bottom: 32px;
    }

    .settings-group:last-child {
      margin-bottom: 0;
    }

    .settings-group__title {
      font-size: 18px;
      font-weight: 600;
      color: #1f2937;
      margin: 0 0 20px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid #e5e7eb;
    }

    .settings-option {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      padding: 16px 0;
      border-bottom: 1px solid #f3f4f6;
    }

    .settings-option:last-child {
      border-bottom: none;
    }

    .settings-option__info {
      flex: 1;
      margin-right: 20px;
    }

    .settings-option__info label {
      display: block;
      font-weight: 500;
      color: #374151;
      margin: 0 0 4px 0;
    }

    .settings-option__info p {
      margin: 0;
      font-size: 14px;
      color: #6b7280;
      line-height: 1.4;
    }

    .settings-select {
      min-width: 160px;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 14px;
      background: white;
      color: #374151;
      transition: all 0.2s ease;
    }

    .settings-select:focus {
      outline: none;
      border-color: #4338ca;
      box-shadow: 0 0 0 3px rgba(67, 56, 202, 0.1);
    }

    .settings-toggle {
      position: relative;
      width: 48px;
      height: 24px;
    }

    .settings-toggle input[type="checkbox"] {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #d1d5db;
      transition: 0.3s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    input:checked + .toggle-slider {
      background: linear-gradient(135deg, #4338ca, #8b5cf6);
    }

    input:checked + .toggle-slider:before {
      transform: translateX(24px);
    }

    .settings-modal__footer {
      padding: 24px 32px;
      background: #f8fafc;
      border-top: 1px solid #e2e8f0;
    }

    .settings-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .settings-actions .btn {
      padding: 10px 20px;
      font-weight: 500;
      border-radius: 8px;
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .settings-actions .btn--primary {
      background: linear-gradient(135deg, #4338ca 0%, #8b5cf6 100%);
      color: white;
      border: none;
    }

    .settings-actions .btn--primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(67, 56, 202, 0.3);
    }

    .settings-actions .btn--ghost {
      background: transparent;
      color: #6b7280;
      border: 1px solid #d1d5db;
    }

    .settings-actions .btn--ghost:hover {
      background: #f9fafb;
      color: #374151;
      border-color: #9ca3af;
    }

    @media (max-width: 768px) {
      .settings-modal__container {
        width: 95vw;
        margin: 2.5vh auto;
        max-height: 95vh;
      }

      .settings-modal__header,
      .settings-content,
      .settings-modal__footer {
        padding-left: 20px;
        padding-right: 20px;
      }

      .settings-tabs {
        padding: 0 20px;
        overflow-x: auto;
      }

      .settings-option {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
      }

      .settings-option__info {
        margin-right: 0;
      }
    }
  </style>

  <!-- JS -->
  <script src="/assets/js/auth.js" defer></script>
  <script src="/assets/js/i18n.js" defer></script>
  <script src="/assets/js/main.js" defer></script>
  <script src="/assets/js/countries.js" defer></script>
  <script src="/assets/js/students_applications.js" defer></script>
  
  <script>
    // Advanced Filtering and Sorting System
    document.addEventListener('DOMContentLoaded', function() {
      // Fields of Study Data
      const fieldsOfStudy = [
        'Accounting', 'Actuarial Science', 'Advertising', 'Aerospace Engineering', 'African Studies',
        'Agricultural Science', 'Agriculture', 'American Studies', 'Anatomy', 'Animal Science',
        'Anthropology', 'Applied Mathematics', 'Applied Physics', 'Arabic', 'Architecture',
        'Art History', 'Artificial Intelligence', 'Asian Studies', 'Astronomy', 'Biochemistry',
        'Bioengineering', 'Biology', 'Biomedical Engineering', 'Biomedical Sciences', 'Biophysics',
        'Biotechnology', 'Business Administration', 'Business Analytics', 'Chemical Engineering', 'Chemistry',
        'Chinese', 'Civil Engineering', 'Classical Studies', 'Communication Studies', 'Computer Engineering',
        'Computer Science', 'Construction Management', 'Criminal Justice', 'Data Science', 'Dentistry',
        'Economics', 'Education', 'Electrical Engineering', 'English Literature', 'Environmental Engineering',
        'Environmental Science', 'European Studies', 'Fashion Design', 'Film Studies', 'Finance',
        'Fine Arts', 'Food Science', 'Forensic Science', 'French', 'Geography',
        'Geology', 'German', 'Graphic Design', 'Health Sciences', 'History',
        'Human Resources', 'Industrial Engineering', 'Information Systems', 'Information Technology', 'International Business',
        'International Relations', 'Italian', 'Japanese', 'Journalism', 'Law',
        'Linguistics', 'Management', 'Marine Biology', 'Marketing', 'Materials Engineering',
        'Mathematics', 'Mechanical Engineering', 'Medicine', 'Microbiology', 'Music',
        'Neuroscience', 'Nursing', 'Nutrition', 'Occupational Therapy', 'Pharmacy',
        'Philosophy', 'Photography', 'Physical Therapy', 'Physics', 'Physiology',
        'Political Science', 'Portuguese', 'Psychology', 'Public Administration', 'Public Health',
        'Public Relations', 'Russian', 'Social Work', 'Sociology', 'Software Engineering',
        'Spanish', 'Statistics', 'Supply Chain Management', 'Theater', 'Tourism Management',
        'Urban Planning', 'Veterinary Medicine'
      ];

      // Advanced Filter System
      const advancedFilterSystem = {
        init() {
          this.populateCountries();
          this.populateFieldsOfStudy();
          this.setupSearchFunctionality();
          this.setupStatusChips();
          this.setupAdvancedFilters();
          this.setupSorting();
          this.setupFilterActions();
          this.loadFilterPresets();
        },

        populateCountries() {
          const countrySelect = document.getElementById('filterCountry');
          if (countrySelect && window.FlowCountries && window.FlowCountries.countries) {
            const countries = window.FlowCountries.countries;
            countries.forEach(country => {
              const option = document.createElement('option');
              option.value = country.code.toLowerCase();
              option.textContent = country.name;
              countrySelect.appendChild(option);
            });
          }
        },

        populateFieldsOfStudy() {
          const fieldSelect = document.getElementById('filterField');
          if (fieldSelect) {
            fieldsOfStudy.forEach(field => {
              const option = document.createElement('option');
              option.value = field.toLowerCase().replace(/\s+/g, '-');
              option.textContent = field;
              fieldSelect.appendChild(option);
            });
          }
        },

        setupSearchFunctionality() {
          const searchInput = document.getElementById('appSearch');
          const clearButton = document.getElementById('searchClear');

          if (searchInput && clearButton) {
            searchInput.addEventListener('input', (e) => {
              const value = e.target.value.trim();
              if (value) {
                clearButton.style.display = 'block';
              } else {
                clearButton.style.display = 'none';
              }
              this.applyFilters();
            });

            clearButton.addEventListener('click', () => {
              searchInput.value = '';
              clearButton.style.display = 'none';
              this.applyFilters();
            });
          }
        },

        setupStatusChips() {
          const statusChips = document.querySelectorAll('[data-status]');
          statusChips.forEach(chip => {
            chip.addEventListener('click', (e) => {
              e.preventDefault();
              statusChips.forEach(c => c.classList.remove('chip--active'));
              chip.classList.add('chip--active');
              this.applyFilters();
            });
          });
        },

        setupAdvancedFilters() {
          const filterElements = [
            'filterCountry',
            'filterLevel', 
            'filterField',
            'filterDeadline',
            'filterPriority'
          ];

          filterElements.forEach(elementId => {
            const element = document.getElementById(elementId);
            if (element) {
              element.addEventListener('change', () => {
                this.applyFilters();
                this.updateFilterCount();
              });
            }
          });
        },

        setupSorting() {
          const sortSelect = document.getElementById('sortBy');
          if (sortSelect) {
            sortSelect.addEventListener('change', () => {
              this.applySorting();
            });
          }
        },

        setupFilterActions() {
          const clearAllBtn = document.getElementById('clearAllFilters');
          const savePresetBtn = document.getElementById('saveFilterPreset');

          if (clearAllBtn) {
            clearAllBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.clearAllFilters();
            });
          }

          if (savePresetBtn) {
            savePresetBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.saveFilterPreset();
            });
          }
        },

        getActiveFilters() {
          const searchValue = document.getElementById('appSearch')?.value?.trim() || '';
          const activeStatusChip = document.querySelector('.chip--active')?.dataset?.status || 'all';
          const country = document.getElementById('filterCountry')?.value || '';
          const level = document.getElementById('filterLevel')?.value || '';
          const field = document.getElementById('filterField')?.value || '';
          const deadline = document.getElementById('filterDeadline')?.value || '';
          const priority = document.getElementById('filterPriority')?.value || '';

          return {
            search: searchValue,
            status: activeStatusChip,
            country,
            level,
            field,
            deadline,
            priority
          };
        },

        applyFilters() {
          const filters = this.getActiveFilters();
          console.log('Applying filters:', filters);
          
          // Get all application elements (would normally be populated by the main app)
          const applications = document.querySelectorAll('.application-item');
          let visibleCount = 0;

          applications.forEach(app => {
            let isVisible = true;

            // Apply search filter
            if (filters.search) {
              const searchableText = (
                app.querySelector('.app-title')?.textContent +
                app.querySelector('.app-university')?.textContent +
                app.querySelector('.app-location')?.textContent || ''
              ).toLowerCase();
              if (!searchableText.includes(filters.search.toLowerCase())) {
                isVisible = false;
              }
            }

            // Apply status filter
            if (filters.status !== 'all') {
              const appStatus = app.dataset.status;
              if (appStatus !== filters.status) {
                isVisible = false;
              }
            }

            // Apply country filter
            if (filters.country) {
              const appCountry = app.dataset.country;
              if (appCountry !== filters.country) {
                isVisible = false;
              }
            }

            // Apply other filters...
            if (filters.level && app.dataset.level !== filters.level) isVisible = false;
            if (filters.field && app.dataset.field !== filters.field) isVisible = false;
            if (filters.deadline) {
              const appDeadline = new Date(app.dataset.deadline);
              const now = new Date();
              
              switch (filters.deadline) {
                case 'overdue':
                  if (appDeadline >= now) isVisible = false;
                  break;
                case 'next-7-days':
                  const nextWeek = new Date();
                  nextWeek.setDate(now.getDate() + 7);
                  if (appDeadline < now || appDeadline > nextWeek) isVisible = false;
                  break;
                case 'next-30-days':
                  const nextMonth = new Date();
                  nextMonth.setDate(now.getDate() + 30);
                  if (appDeadline < now || appDeadline > nextMonth) isVisible = false;
                  break;
                case 'next-3-months':
                  const nextQuarter = new Date();
                  nextQuarter.setMonth(now.getMonth() + 3);
                  if (appDeadline < now || appDeadline > nextQuarter) isVisible = false;
                  break;
                case 'future':
                  if (appDeadline <= now) isVisible = false;
                  break;
              }
            }
            if (filters.priority && app.dataset.priority !== filters.priority) isVisible = false;

            // Apply visibility
            app.style.display = isVisible ? 'block' : 'none';
            if (isVisible) visibleCount++;
          });

          // Update applications count
          const countElement = document.getElementById('appsCount');
          if (countElement) {
            countElement.textContent = `${visibleCount} application${visibleCount !== 1 ? 's' : ''}`;
          }

          this.updateFilterCount();
        },

        applySorting() {
          const sortBy = document.getElementById('sortBy')?.value || 'updated';
          const applicationsList = document.getElementById('appsList');
          if (!applicationsList) return;

          const applications = Array.from(applicationsList.children);
          
          applications.sort((a, b) => {
            switch (sortBy) {
              case 'updated':
                return new Date(b.dataset.updated || '1970-01-01') - new Date(a.dataset.updated || '1970-01-01');
              case 'created':
                return new Date(b.dataset.created || '1970-01-01') - new Date(a.dataset.created || '1970-01-01');
              case 'deadline-asc':
                return new Date(a.dataset.deadline || '2099-12-31') - new Date(b.dataset.deadline || '2099-12-31');
              case 'deadline-desc':
                return new Date(b.dataset.deadline || '1970-01-01') - new Date(a.dataset.deadline || '1970-01-01');
              case 'name-asc':
                const nameA = a.querySelector('.app-university')?.textContent || '';
                const nameB = b.querySelector('.app-university')?.textContent || '';
                return nameA.localeCompare(nameB);
              case 'name-desc':
                const nameA2 = a.querySelector('.app-university')?.textContent || '';
                const nameB2 = b.querySelector('.app-university')?.textContent || '';
                return nameB2.localeCompare(nameA2);
              case 'program-asc':
                const programA = a.querySelector('.app-title')?.textContent || '';
                const programB = b.querySelector('.app-title')?.textContent || '';
                return programA.localeCompare(programB);
              case 'program-desc':
                const programA2 = a.querySelector('.app-title')?.textContent || '';
                const programB2 = b.querySelector('.app-title')?.textContent || '';
                return programB2.localeCompare(programA2);
              case 'status':
                const statusOrder = {'draft': 0, 'review': 1, 'submitted': 2, 'accepted': 3, 'rejected': 4};
                return (statusOrder[a.dataset.status] || 0) - (statusOrder[b.dataset.status] || 0);
              case 'priority':
                const priorityOrder = {'high': 0, 'medium': 1, 'low': 2};
                return (priorityOrder[a.dataset.priority] || 2) - (priorityOrder[b.dataset.priority] || 2);
              case 'completion':
                const completionA = parseInt(a.dataset.completion || '0');
                const completionB = parseInt(b.dataset.completion || '0');
                return completionB - completionA;
              default:
                return 0;
            }
          });

          // Re-append sorted applications
          applications.forEach(app => applicationsList.appendChild(app));
        },

        updateFilterCount() {
          const filters = this.getActiveFilters();
          let activeFilterCount = 0;
          
          if (filters.search) activeFilterCount++;
          if (filters.status !== 'all') activeFilterCount++;
          if (filters.country) activeFilterCount++;
          if (filters.level) activeFilterCount++;
          if (filters.field) activeFilterCount++;
          if (filters.deadline) activeFilterCount++;
          if (filters.priority) activeFilterCount++;

          // Add filter count indicator if needed
          const filterTitle = document.querySelector('.apps-aside .card__title');
          let countElement = filterTitle?.querySelector('.filter-count');
          
          if (activeFilterCount > 0) {
            if (!countElement) {
              countElement = document.createElement('span');
              countElement.className = 'filter-count';
              filterTitle?.appendChild(countElement);
            }
            countElement.textContent = activeFilterCount;
            countElement.style.display = 'inline';
          } else if (countElement) {
            countElement.style.display = 'none';
          }
        },

        clearAllFilters() {
          document.getElementById('appSearch').value = '';
          document.getElementById('searchClear').style.display = 'none';
          
          document.querySelectorAll('.chip').forEach(chip => {
            chip.classList.remove('chip--active');
          });
          document.querySelector('[data-status="all"]')?.classList.add('chip--active');
          
          ['filterCountry', 'filterLevel', 'filterField', 'filterDeadline', 'filterPriority', 'sortBy'].forEach(id => {
            const element = document.getElementById(id);
            if (element) element.value = '';
          });

          // Reset sort to default
          document.getElementById('sortBy').value = 'updated';
          
          this.applyFilters();
          this.applySorting();
          this.showToast('All filters cleared', 'info');
        },

        saveFilterPreset() {
          const filters = this.getActiveFilters();
          const presetName = prompt('Enter a name for this filter preset:');
          
          if (presetName && presetName.trim()) {
            try {
              const savedPresets = JSON.parse(localStorage.getItem('applicationFilterPresets') || '{}');
              savedPresets[presetName.trim()] = filters;
              localStorage.setItem('applicationFilterPresets', JSON.stringify(savedPresets));
              this.showToast(`Filter preset "${presetName}" saved!`, 'success');
            } catch (e) {
              this.showToast('Failed to save preset', 'error');
            }
          }
        },

        loadFilterPresets() {
          try {
            const savedPresets = JSON.parse(localStorage.getItem('applicationFilterPresets') || '{}');
            if (Object.keys(savedPresets).length > 0) {
              console.log('Available filter presets:', Object.keys(savedPresets));
            }
          } catch (e) {
            console.log('No saved presets found');
          }
        },

        showToast(message, type = 'info') {
          console.log(`[${type.toUpperCase()}] ${message}`);
        }
      };

      // Initialize the advanced filter system
      advancedFilterSystem.init();
    });

    // Advanced Settings System
    document.addEventListener('DOMContentLoaded', function() {
      const settingsSystem = {
        modal: null,
        isOpen: false,
        activeTab: 'appearance',
        
        settings: {
          theme: 'auto',
          density: 'comfortable',
          animations: true,
          particles: true,
          language: 'en',
          timezone: 'auto',
          pushNotifications: true,
          applicationUpdates: true,
          messageNotifications: true,
          emailDigest: false,
          reducedMotion: false,
          highContrast: false,
          fontSize: 'medium'
        },
        
        init() {
          this.modal = document.getElementById('settingsModal');
          this.setupEventListeners();
          this.loadSettings();
          this.applySettings();
        },
        
        setupEventListeners() {
          const toggleBtn = document.getElementById('settingsToggle');
          if (toggleBtn) {
            toggleBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.openModal();
            });
          }
          
          const closeBtn = document.getElementById('settingsClose');
          if (closeBtn) {
            closeBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.closeModal();
            });
          }
          
          if (this.modal) {
            const backdrop = this.modal.querySelector('.settings-modal__backdrop');
            if (backdrop) {
              backdrop.addEventListener('click', () => {
                this.closeModal();
              });
            }
          }
          
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && this.isOpen) {
              this.closeModal();
            }
          });
          
          const tabs = document.querySelectorAll('.settings-tab');
          tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
              e.preventDefault();
              const tabName = tab.dataset.tab;
              this.switchTab(tabName);
            });
          });
          
          this.setupSettingsControls();
          
          const saveBtn = document.getElementById('saveSettings');
          const resetBtn = document.getElementById('resetSettings');
          
          if (saveBtn) {
            saveBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.saveSettings();
            });
          }
          
          if (resetBtn) {
            resetBtn.addEventListener('click', (e) => {
              e.preventDefault();
              this.resetSettings();
            });
          }
        },
        
        setupSettingsControls() {
          const themeSelect = document.getElementById('themeSelect');
          if (themeSelect) {
            themeSelect.addEventListener('change', (e) => {
              this.settings.theme = e.target.value;
              this.applyTheme();
            });
          }
          
          const densitySelect = document.getElementById('densitySelect');
          if (densitySelect) {
            densitySelect.addEventListener('change', (e) => {
              this.settings.density = e.target.value;
              this.applyDensity();
            });
          }
          
          const languageSelect = document.getElementById('languageSelect');
          if (languageSelect) {
            languageSelect.addEventListener('change', (e) => {
              this.settings.language = e.target.value;
            });
          }
          
          const toggles = ['animationsToggle', 'particlesToggle', 'pushNotifications', 'applicationUpdates', 'messageNotifications', 'emailDigest', 'reducedMotion', 'highContrast'];
          toggles.forEach(toggleId => {
            const toggle = document.getElementById(toggleId);
            if (toggle) {
              toggle.addEventListener('change', (e) => {
                const settingKey = toggleId.replace('Toggle', '');
                this.settings[settingKey] = e.target.checked;
                this.applyToggleSetting(settingKey);
              });
            }
          });
        },
        
        openModal() {
          if (this.modal) {
            this.modal.setAttribute('aria-hidden', 'false');
            this.isOpen = true;
            document.body.style.overflow = 'hidden';
            
            const firstFocusable = this.modal.querySelector('button, input, select');
            if (firstFocusable) {
              setTimeout(() => firstFocusable.focus(), 100);
            }
          }
        },
        
        closeModal() {
          if (this.modal) {
            this.modal.setAttribute('aria-hidden', 'true');
            this.isOpen = false;
            document.body.style.overflow = '';
          }
        },
        
        switchTab(tabName) {
          this.activeTab = tabName;
          
          const tabs = document.querySelectorAll('.settings-tab');
          const panels = document.querySelectorAll('.settings-panel');
          
          tabs.forEach(tab => {
            tab.classList.remove('settings-tab--active');
          });
          panels.forEach(panel => {
            panel.classList.remove('settings-panel--active');
          });
          
          const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
          const activePanel = document.querySelector(`[data-panel="${tabName}"]`);
          
          if (activeTab) activeTab.classList.add('settings-tab--active');
          if (activePanel) activePanel.classList.add('settings-panel--active');
        },
        
        loadSettings() {
          try {
            const saved = localStorage.getItem('flowSettings');
            if (saved) {
              this.settings = { ...this.settings, ...JSON.parse(saved) };
            }
          } catch (e) {
            console.log('Settings load error:', e);
          }
          this.updateUI();
        },
        
        saveSettings() {
          try {
            localStorage.setItem('flowSettings', JSON.stringify(this.settings));
            this.showToast('Settings saved successfully!', 'success');
            this.closeModal();
          } catch (e) {
            this.showToast('Failed to save settings', 'error');
          }
        },
        
        resetSettings() {
          if (confirm('Are you sure you want to reset all settings to default?')) {
            this.settings = {
              theme: 'auto',
              density: 'comfortable',
              animations: true,
              particles: true,
              language: 'en',
              timezone: 'auto',
              pushNotifications: true,
              applicationUpdates: true,
              messageNotifications: true,
              emailDigest: false,
              reducedMotion: false,
              highContrast: false,
              fontSize: 'medium'
            };
            this.updateUI();
            this.applySettings();
            this.showToast('Settings reset to defaults', 'info');
          }
        },
        
        updateUI() {
          Object.keys(this.settings).forEach(key => {
            const element = document.getElementById(`${key}Select`) || document.getElementById(`${key}Toggle`);
            if (element) {
              if (element.type === 'checkbox') {
                element.checked = this.settings[key];
              } else {
                element.value = this.settings[key];
              }
            }
          });
        },
        
        applySettings() {
          this.applyTheme();
          this.applyDensity();
          Object.keys(this.settings).forEach(key => {
            if (typeof this.settings[key] === 'boolean') {
              this.applyToggleSetting(key);
            }
          });
        },
        
        applyTheme() {
          const theme = this.settings.theme;
          document.documentElement.setAttribute('data-theme', theme);
        },
        
        applyDensity() {
          const density = this.settings.density;
          document.documentElement.setAttribute('data-density', density);
        },
        
        applyToggleSetting(key) {
          const value = this.settings[key];
          document.documentElement.setAttribute(`data-${key.toLowerCase()}`, value);
        },
        
        showToast(message, type = 'info') {
          console.log(`[${type.toUpperCase()}] ${message}`);
        }
      };
      
      settingsSystem.init();
    });
  </script>
</body>
</html>
